<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RussianTUB | RAXICH ELITE</title>
    <style>
        :root { 
            --bg: #050505; --card: #111; --text: #fff; --accent: #ff0000; --meta: #aaa; 
            --shadow: 0 0 20px rgba(255, 0, 0, 0.5); --inp: #000;
        }
        body.light-theme {
            --bg: #f0f0f0; --card: #ffffff; --text: #000; --meta: #555;
            --shadow: 0 0 15px rgba(0, 0, 0, 0.1); --inp: #e0e0e0;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Segoe UI', sans-serif; transition: background 0.3s, color 0.3s; }
        html { scroll-behavior: smooth; }
        body { margin: 0; background: var(--bg); color: var(--text); overflow: hidden; height: 100vh; }

        /* –ò–ù–¢–†–û */
        #intro {
            position: fixed; inset: 0; background: #000; z-index: 10000;
            display: flex; align-items: center; justify-content: center;
            animation: fadeOut 0.5s ease 4.5s forwards;
            pointer-events: none;
        }
        .intro-container { display: flex; align-items: center; gap: 0; }
        .intro-logo {
            width: 60px; height: 60px; background: red; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 35px; font-weight: 900; color: #fff; box-shadow: 0 0 40px red;
            animation: dropAndShake 1.2s ease-out forwards, moveToStart 0.4s ease 1.8s forwards;
            z-index: 2;
        }
        .intro-text { display: flex; font-size: 40px; font-weight: 900; color: #fff; margin-left: 5px; }
        .intro-text span { opacity: 0; width: 0; transform: translateX(-10px); animation: letterPop 0.3s forwards; }
        
        @keyframes dropAndShake {
            0% { transform: translateY(-100vh); }
            50% { transform: translateY(0); }
            60% { transform: translate(3px, 3px) rotate(3deg); }
            80% { transform: translate(-3px, -3px) rotate(-3deg); }
            100% { transform: translate(0,0); }
        }
        @keyframes moveToStart { to { transform: scale(0.75); } }
        @keyframes letterPop { to { opacity: 1; width: auto; transform: translateX(0); } }
        @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }

        /* –ò–ù–¢–ï–†–§–ï–ô–° */
        .header { display: flex; align-items: center; justify-content: space-between; padding: 0 15px; background: var(--card); border-bottom: 1px solid rgba(128,128,128,0.2); height: 65px; position: relative; z-index: 1000; }
        .logo { display: flex; align-items: center; gap: 10px; font-weight: 900; font-size: 16px; }
        .logo-sq { width: 32px; height: 32px; background: red; border-radius: 8px; color: #fff; display: flex; align-items: center; justify-content: center; }

        .user-info { text-align: right; line-height: 1.2; cursor: pointer; }
        #u-id { font-size: 10px; color: var(--meta); font-weight: bold; }
        #u-name { font-size: 13px; font-weight: 900; color: red; }

        .ad-banner {
            background: var(--card); border: 1px dashed red; border-radius: 12px;
            padding: 12px; text-align: center; margin: 15px 0;
            color: var(--meta); font-size: 11px; font-weight: bold;
        }

        .cat-scroll { display: flex; overflow-x: auto; gap: 10px; padding: 5px 0 15px; scrollbar-width: none; }
        .cat-btn { padding: 10px 18px; border-radius: 25px; border: 1px solid #333; background: var(--card); color: var(--text); font-weight: bold; font-size: 11px; white-space: nowrap; cursor: pointer; }
        .cat-btn.active { background: red; border-color: red; color: white; }

        .page-container { height: calc(100vh - 140px); overflow-y: auto; padding: 15px; }
        .page { display: none; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        #list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .v-card { background: var(--card); border-radius: 16px; overflow: hidden; border: 1px solid rgba(128,128,128,0.1); position: relative; }
        .v-thumb { width: 100%; aspect-ratio: 16/9; object-fit: cover; display: block; background: #222; }
        .v-title { padding: 12px; font-size: 13px; font-weight: 700; color: var(--text); overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }

        .fav-btn { position: absolute; bottom: 10px; right: 10px; background: rgba(0,0,0,0.5); border: none; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; z-index: 5; }
        .fav-btn svg { width: 18px; fill: #fff; }
        .fav-btn.active svg { fill: red; }

        .nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: var(--card); display: flex; border-top: 1px solid rgba(128,128,128,0.2); }
        .nav-item { flex: 1; border: none; background: none; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--meta); cursor: pointer; }
        .nav-item.active { color: red; }
        .nav-item svg { width: 22px; height: 22px; fill: currentColor; }

        .btn-theme { background: none; border: none; cursor: pointer; color: var(--text); display: flex; align-items: center; padding: 5px; }
        .btn-theme svg { width: 20px; height: 20px; fill: currentColor; }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 11000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-box { background: var(--card); padding: 30px; border-radius: 20px; width: 90%; max-width: 380px; border: 1px solid red; text-align: center; }
        input { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid #333; background: var(--inp); color: var(--text); margin-bottom: 10px; outline: none; }
        .btn-red { width: 100%; padding: 15px; background: red; color: white; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; }
        
        #player { position: fixed; inset: 0; background: #000; z-index: 15000; display: none; }
    </style>
</head>
<body>

<div id="intro">
    <div class="intro-container">
        <div class="intro-logo">R</div>
        <div class="intro-text" id="intro-name"></div>
    </div>
</div>

<div class="header">
    <div class="logo"><div class="logo-sq">R</div> RussianTUB</div>
    <div style="display:flex; gap:10px; align-items:center;">
        <button class="btn-theme" onclick="toggleTheme()" id="theme-icon">
            <svg viewBox="0 0 24 24"><path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zM2 13h2a1 1 0 0 0 0-2H2a1 1 0 0 0 0 2zm18 0h2a1 1 0 0 0 0-2h-2a1 1 0 0 0 0 2zM11 2v2a1 1 0 0 0 2 0V2a1 1 0 0 0-2 0zm0 18v2a1 1 0 0 0 2 0v-2a1 1 0 0 0-2 0zM5.99 4.58a1 1 0 1 0-1.41 1.41l1.06 1.06a1 1 0 1 0 1.41-1.41L5.99 4.58zm12.37 12.37a1 1 0 1 0-1.41 1.41l1.06 1.06a1 1 0 1 0 1.41-1.41l-1.06-1.06zm1.06-12.37a1 1 0 1 0-1.41-1.41l-1.06 1.06a1 1 0 1 0 1.41 1.41l1.06-1.06zM7.05 18.36a1 1 0 1 0-1.41-1.41l-1.06 1.06a1 1 0 1 0 1.41 1.41l1.06-1.06z"/></svg>
        </button>
        <button onclick="openM('m-author')" style="background:none; border:1px solid red; color:red; border-radius:5px; font-size:9px; padding:4px 8px; font-weight:bold; cursor:pointer;">–ê–í–¢–û–†</button>
        <div id="user-zone">
            <button id="btn-login" onclick="openM('m-auth')" style="background:red; color:white; border:none; padding:8px 15px; border-radius:8px; font-weight:bold; font-size:10px; cursor:pointer;">–í–•–û–î</button>
            <div id="user-profile" class="user-info" style="display:none;">
                <div id="u-name"></div>
                <div id="u-id"></div>
            </div>
        </div>
    </div>
</div>

<div class="page-container">
    <div id="p-main" class="page" style="display:block;">
        <input type="text" id="q" placeholder="–ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ..." onkeydown="if(event.key==='Enter') search(this.value)">
        <div class="ad-banner">üì¢ –¢—É—Ç –º–æ–≥–ª–∞ –±—ã—Ç—å –≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞</div>
        <div class="cat-scroll">
            <div class="cat-btn active" onclick="setCat('–¢—Ä–µ–Ω–¥—ã', this)">–¢—Ä–µ–Ω–¥—ã</div>
            <div class="cat-btn" onclick="setCat('–°–ø–æ—Ä—Ç', this)">–°–ø–æ—Ä—Ç</div>
            <div class="cat-btn" onclick="setCat('–ò–≥—Ä—ã', this)">–ò–≥—Ä—ã</div>
            <div class="cat-btn" onclick="setCat('–ú—É–∑—ã–∫–∞', this)">–ú—É–∑—ã–∫–∞</div>
        </div>
        <div id="list"></div>
    </div>

    <div id="p-news" class="page">
        <h2 style="color:red;">NEWS</h2>
        <div style="background:var(--card); padding:15px; border-radius:15px; border-left:4px solid red;">
            <b>v51.0 ELITE</b><p>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±–ª–æ–∂–µ–∫ –≤ –ø–æ–∏—Å–∫–µ. –í—Å–µ –º–æ–¥—É–ª–∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.</p>
        </div>
    </div>

    <div id="p-chat" class="page">
        <h2>CHAT</h2>
        <div id="chat-box" style="height:350px; overflow-y:auto; background:rgba(128,128,128,0.1); border-radius:15px; padding:15px;"></div>
        <div style="display:flex; gap:10px; margin-top:15px;">
            <input type="text" id="msg-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
            <button onclick="sendMsg()" style="background:red; color:white; border:none; border-radius:10px; padding:0 20px;">></button>
        </div>
    </div>

    <div id="p-set" class="page">
        <h2>SYSTEM</h2>
        <button class="btn-red" onclick="openM('m-don')" style="margin-bottom:15px; background:#21a038;">–ü–û–î–î–ï–†–ñ–ê–¢–¨ –ü–†–û–ï–ö–¢ (–°–ë–ü)</button>
        <button class="btn-red" onclick="window.open('https://t.me/raxich_support')" style="background:none; border:2px solid #0088cc; color:#0088cc; margin-bottom:15px;">–°–õ–£–ñ–ë–ê –ü–û–î–î–ï–†–ñ–ö–ò</button>
        <h3 style="color:red;">–ò–ó–ë–†–ê–ù–ù–û–ï</h3>
        <div id="fav-list"></div>
    </div>
</div>

<div class="nav">
    <button class="nav-item active" onclick="showP('main', 0)"><svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg><span>HOME</span></button>
    <button class="nav-item" onclick="showP('news', 1)"><svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 14H7v-2h10v2zm0-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg><span>NEWS</span></button>
    <button class="nav-item" onclick="showP('chat', 2)"><svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg><span>CHAT</span></button>
    <button class="nav-item" onclick="showP('set', 3)"><svg viewBox="0 0 24 24"><path d="M12 15.5A3.5 3.5 0 1 1 15.5 12 3.5 3.5 0 0 1 12 15.5z"/></svg><span>SYSTEM</span></button>
</div>

<div id="m-auth" class="modal" onclick="closeM('m-auth')">
    <div class="modal-box" onclick="event.stopPropagation()">
        <h2>–í–•–û–î</h2>
        <input type="text" id="n-in" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º">
        <button class="btn-red" onclick="auth()">–í–û–ô–¢–ò</button>
    </div>
</div>

<div id="m-don" class="modal" onclick="closeM('m-don')">
    <div class="modal-box"><h2>–î–û–ù–ê–¢</h2><button class="btn-red" onclick="window.open('https://yoomoney.ru/to/4100119454625159')">–û–ü–õ–ê–¢–ò–¢–¨</button></div>
</div>

<div id="m-author" class="modal" onclick="closeM('m-author')">
    <div class="modal-box"><h3>RAXICH</h3><p>Elite Dev</p></div>
</div>

<div id="player">
    <div id="pf" style="height:100%;"></div>
    <button onclick="closeP()" style="position:fixed; top:20px; left:20px; background:red; color:white; border:none; padding:10px 20px; border-radius:10px; font-weight:bold;">–ó–ê–ö–†–´–¢–¨</button>
</div>

<script>
    // GitHub API Protection
    const _k1 = "AIzaSyDplou07qJ1i";
    const _k2 = "TusN_dYoNvF2NI610jAOck";
    const API_K = _k1 + _k2;

    let favs = JSON.parse(localStorage.getItem('f') || '[]');

    const txt = "ussianTUB";
    const container = document.getElementById('intro-name');
    txt.split('').forEach((l, i) => {
        const s = document.createElement('span'); s.innerText = l;
        s.style.animationDelay = (2.1 + i * 0.1) + 's';
        container.appendChild(s);
    });

    function toggleTheme() {
        document.body.classList.toggle('light-theme');
        const isLight = document.body.classList.contains('light-theme');
        localStorage.setItem('theme', isLight ? 'light' : 'dark');
        document.getElementById('theme-icon').innerHTML = isLight ? 
            '<svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"/></svg>' : 
            '<svg viewBox="0 0 24 24"><path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zM2 13h2a1 1 0 0 0 0-2H2a1 1 0 0 0 0 2zm18 0h2a1 1 0 0 0 0-2h-2a1 1 0 0 0 0 2zM11 2v2a1 1 0 0 0 2 0V2a1 1 0 0 0-2 0zm0 18v2a1 1 0 0 0 2 0v-2a1 1 0 0 0-2 0zM5.99 4.58a1 1 0 1 0-1.41 1.41l1.06 1.06a1 1 0 1 0 1.41-1.41L5.99 4.58zm12.37 12.37a1 1 0 1 0-1.41 1.41l1.06 1.06a1 1 0 1 0 1.41-1.41l-1.06-1.06zm1.06-12.37a1 1 0 1 0-1.41-1.41l-1.06 1.06a1 1 0 1 0 1.41 1.41l1.06-1.06zM7.05 18.36a1 1 0 1 0-1.41-1.41l-1.06 1.06a1 1 0 1 0 1.41 1.41l1.06-1.06z"/></svg>';
    }

    async function search(q) {
        try {
            const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=20&q=${encodeURIComponent(q)}&type=video&key=${API_K}`);
            const data = await res.json();
            const list = document.getElementById('list'); list.innerHTML = '';
            data.items.forEach(v => {
                const id = v.id.videoId;
                const isFav = favs.find(f => f.id === id);
                const thumb = `https://i.ytimg.com/vi/${id}/mqdefault.jpg`;
                const d = document.createElement('div'); d.className = 'v-card';
                d.innerHTML = `
                    <div onclick="play('${id}')">
                        <img src="${thumb}" class="v-thumb" onerror="this.src='https://via.placeholder.com/320x180?text=No+Image'">
                        <div class="v-title">${v.snippet.title}</div>
                    </div>
                    <button class="fav-btn ${isFav?'active':''}" onclick="toggleFav('${id}', '${v.snippet.title.replace(/'/g,'')}', '${thumb}', this)">
                        <svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                    </button>`;
                list.appendChild(d);
            });
        } catch (e) {}
    }

    function setCat(c, b) {
        document.querySelectorAll('.cat-btn').forEach(x => x.classList.remove('active'));
        b.classList.add('active'); search(c);
    }

    function toggleFav(id, t, img, btn) {
        const idx = favs.findIndex(f => f.id === id);
        if(idx === -1) { favs.push({id, t, img}); btn.classList.add('active'); } 
        else { favs.splice(idx, 1); btn.classList.remove('active'); }
        localStorage.setItem('f', JSON.stringify(favs));
        renderFavs();
    }

    function renderFavs() {
        const fl = document.getElementById('fav-list'); fl.innerHTML = '';
        favs.forEach(i => {
            const d = document.createElement('div'); d.style = "display:flex; gap:10px; margin-bottom:10px; background:var(--card); padding:10px; border-radius:12px; border:1px solid red; cursor:pointer;";
            d.innerHTML = `<img src="${i.img}" style="width:70px; border-radius:5px;"> <div style="font-size:11px; color:var(--text);">${i.t.substring(0,30)}...</div>`;
            d.onclick = () => play(i.id); fl.appendChild(d);
        });
    }

    function sendMsg() {
        const i = document.getElementById('msg-input'); if(!i.value) return;
        const b = document.getElementById('chat-box');
        const m = document.createElement('div');
        m.style = "background:var(--inp); padding:10px; border-radius:8px; margin-bottom:8px; border-left:3px solid red; font-size:13px; color:var(--text);";
        m.innerHTML = `<b style="color:red;">${localStorage.getItem('u') || '–ì–æ—Å—Ç—å'}</b><br>${i.value}`;
        b.appendChild(m); i.value = ''; b.scrollTop = b.scrollHeight;
    }

    function auth() {
        const n = document.getElementById('n-in').value; if(!n) return;
        localStorage.setItem('u', n); 
        localStorage.setItem('i', n.toUpperCase()==='RAXICH'?'#BOSS':'#'+Math.floor(1000+Math.random()*9000));
        location.reload();
    }

    function play(id) {
        document.getElementById('player').style.display='block';
        document.getElementById('pf').innerHTML=`<iframe src="https://www.youtube-nocookie.com/embed/${id}?autoplay=1" style="width:100%;height:100%;border:none;" allowfullscreen></iframe>`;
    }

    function showP(id, idx) {
        document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
        document.getElementById('p-'+id).style.display = 'block';
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.querySelectorAll('.nav-item')[idx].classList.add('active');
    }

    function openM(id){ document.getElementById(id).style.display='flex'; }
    function closeM(id){ document.getElementById(id).style.display='none'; }
    function closeP(){ document.getElementById('player').style.display='none'; document.getElementById('pf').innerHTML=''; }

    window.onload = () => {
        if(localStorage.getItem('theme') === 'light') toggleTheme();
        const u = localStorage.getItem('u');
        if(u) {
            document.getElementById('btn-login').style.display='none';
            document.getElementById('user-profile').style.display='block';
            document.getElementById('u-name').innerText = u.toUpperCase();
            document.getElementById('u-id').innerText = localStorage.getItem('i');
        }
        search('–¢—Ä–µ–Ω–¥—ã'); renderFavs();
    };
</script>
</body>
</html>